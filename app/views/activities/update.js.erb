<% if @activity.valid? %>
  $("#row_for_activity_<%= @activity.id %>").html("<%= escape_javascript render(@activity) %>");
  // Update total sum
  $("#project_total_time").html('<%= number_with_delimiter(@project.activities.sum(:time)) %>');
<% else %>
  $('<div id="activity-error"></div>')
		.html('<div class="alert">Please fix the following errors: <%= escape_javascript @activity.errors.full_messages.to_sentence %></div>')
		.dialog({
			autoOpen: true,
			buttons: { 'OK' : function(){ $(this).dialog("close"); } },
			modal: true,
			show: "fade",
			hide: "fade",
    });
<% end %>