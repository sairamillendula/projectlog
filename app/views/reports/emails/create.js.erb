<% if @email.valid? %>
  $('<div id="email-sent"></div>')
		.html('<div class="notice">Email successfully sent!</div>')
		.dialog({
			autoOpen: true,
			buttons: { 'OK' : function(){ $(this).dialog("close"); } },
			show: "fade",
			hide: "fade",
    });
  $("#send_report_email_dialog").dialog("destroy").remove();
  $('#reports_email_to').expire();
<% else %>
  $("#send_report_email_dialog .status_indicator").html("");
  //Enable Send button again
  $("#send_report_email_dialog").parent().find("button:contains('Send')").button("enable");  
  $('<div id="email-error"></div>')
		.html('<div class="alert">Please fix the following errors: <br /><%= escape_javascript @email.errors.full_messages.to_sentence %></div>')
		.dialog({
			autoOpen: true,
			buttons: { 'OK' : function(){ $(this).dialog("destroy").remove(); } },
			show: "fade",
			hide: "fade",
    });
<% end %>