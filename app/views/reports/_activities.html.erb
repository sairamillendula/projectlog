<div id="activities">  
  
  <% if @activities.empty? %>
  <div class="no-occurence">
    <p>No activity matches your search criteria.</p>
  </div>
  <% else %>

  <h2>Activities</h2>
     <%= form_tag search_reports_path, :method => "get", :remote => true, :id => "activities_search" do %>
  <div id="activity-filter">
    <%= hidden_field_tag :direction, params[:direction] %>
    <%= hidden_field_tag :sort, params[:sort] %>
    <%= hidden_field_tag :project_id, params[:project_id] %>
    <%= hidden_field_tag :start_date, params[:start_date] %>
    <%= hidden_field_tag :end_date, params[:end_date] %>
    <%= text_field_tag :search, params[:search] %>
    <%= submit_tag "Filter", :name => nil %>
	<div id="export" class="right">
	    Export this table to CSV | 
	<%= link_to 'Email Report', '#', :onclick => "$('#email_timesheet').dialog()" %> <%= render :partial => 'reports/timesheet' %> |
	<%= link_to "Download PDF", params.merge(:format => :pdf) %>
	</div>
	<div id="email_timesheet"><%= render :partial => 'reports/timesheet' %></div>
  </div>
  <% end %>
   
  <table>
    <tr>
      <th><%= sortable "date", { :action => "search", :controller => "reports" } %></th>
      <th><%= sortable "time", { :action => "search", :controller => "reports" } %></th>
      <th><%= sortable "description", { :action => "search", :controller => "reports" } %></th>
      <th><%= sortable "project_id", { :action => "search", :controller => "reports" }, "Project" %></th>
      <th></th>
      <th></th>
    </tr>

    <% @activities.each do |activity| %>
    <tr>
      <td class="date"><%= l activity.date, :format => :short %></td>
      <td class="time"><%= activity.time %></td>
      <td class="description"><%= activity.description %></td>
      <td class="project"><%= activity.project.title %></td>      
      <td class="actions"><%= link_to 'Edit', edit_project_activity_path(activity.project, activity) %></td>
      <td class="actions"><%= link_to 'Destroy', project_activity_path(activity.project, activity), :confirm => 'Are you sure?', :method => :delete %></td>
    </tr>
    <% end %>

    <tr class="total">
      <th class="total right">TOTAL</th>
      <th><%= @total_time %></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </table>

  <div class="right">
    <%= paginate @activities, :params => { :action => "search", :controller => "reports" } %>
  </div>
  
<% end %>
</div>


